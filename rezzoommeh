<style>
    /* --- Ú†ÛŒØ¯Ù…Ø§Ù† Ú©Ù„ÛŒ --- */
    .resume-split { display: flex; height: 100vh; overflow: hidden; background: #0f172a; }
    .resume-editor { width: 380px; background: #1e293b; border-left: 2px solid #00eaff; overflow-y: auto; padding: 20px; z-index: 10; display: flex; flex-direction: column; gap: 15px; }
    .resume-preview-area { flex: 1; background: #525659; display: flex; flex-direction: column; align-items: center; overflow-y: auto; padding: 40px; gap: 20px; }
    
    /* --- Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ø¯ÛŒØªÙˆØ± --- */
    .res-group { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1); }
    .res-group h4 { margin: 0 0 15px 0; color: #00eaff; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px dashed #444; padding-bottom: 8px; }
    .res-input { width: 100%; padding: 10px; background: #0f172a; border: 1px solid #334155; color: #fff; margin-bottom: 10px; border-radius: 8px; font-size: 13px; transition: 0.2s; }
    .res-input:focus { border-color: #00eaff; outline: none; }
    .res-btn-add { background: #22c55e; color: white; border: none; padding: 2px 8px; border-radius: 4px; cursor: pointer; font-size: 12px; }
    .del-btn { color: #ef4444; cursor: pointer; float: left; }

    /* --- Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ú©Ø§ØºØ° Ùˆ ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ --- */
    .resume-page { 
        width: 210mm; height: 296mm; background: white; color: #333; 
        box-shadow: 0 0 50px rgba(0,0,0,0.5); position: relative; overflow: hidden; 
        display: flex; flex-direction: column; padding: 0; margin-bottom: 20px;
        transition: 0.3s;
    }
    
    /* Ø®Ø· Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø´Ú©Ø³Øª ØµÙØ­Ù‡ (ÙÙ‚Ø· Ø¨ØµØ±ÛŒ) */
    .page-break-marker {
        width: 100%; height: 2px; background: repeating-linear-gradient(90deg, red 0, red 10px, transparent 10px, transparent 20px);
        position: absolute; bottom: 0; left: 0; pointer-events: none; opacity: 0.5;
    }

    /* --- Ù‚Ø§Ù„Ø¨ Ø´Ù…Ø§Ø±Ù‡ Û±: Ú©Ù„Ø§Ø³ÛŒÚ© (Ø±Ø³Ù…ÛŒ) --- */
    .theme-classic .r-header { background: #f1f5f9; padding: 30px; border-bottom: 3px solid #334155; display: flex; align-items: center; gap: 20px; }
    .theme-classic .r-photo { width: 100px; height: 100px; object-fit: cover; border-radius: 5px; border: 1px solid #ccc; }
    .theme-classic .r-body { padding: 30px; display: flex; gap: 30px; }
    .theme-classic .r-left { width: 65%; }
    .theme-classic .r-right { width: 35%; border-left: 1px solid #ddd; padding-left: 20px; }
    .theme-classic .r-title { font-size: 16px; font-weight: bold; border-bottom: 2px solid #334155; margin-bottom: 15px; padding-bottom: 5px; color: #334155; text-transform: uppercase; }

    /* --- Ù‚Ø§Ù„Ø¨ Ø´Ù…Ø§Ø±Ù‡ Û²: Ù…Ø¯Ø±Ù† (Ø´ÛŒÚ©) --- */
    .theme-modern .r-header { background: #2563eb; color: white; padding: 40px; text-align: center; }
    .theme-modern .r-photo { width: 110px; height: 110px; object-fit: cover; border-radius: 50%; border: 4px solid rgba(255,255,255,0.3); margin-bottom: 10px; }
    .theme-modern .r-body { display: flex; flex-direction: row-reverse; height: 100%; }
    .theme-modern .r-right { width: 30%; background: #1e293b; color: #fff; padding: 20px; min-height: 200mm; }
    .theme-modern .r-left { width: 70%; padding: 25px; }
    .theme-modern .r-title { font-size: 15px; font-weight: bold; color: #2563eb; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
    .theme-modern .r-right .r-title { color: #00eaff; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 5px; }
    .theme-modern .r-item-sub { color: #64748b; }
    .theme-modern .r-right .r-item-sub { color: #94a3b8; }

    /* --- Ù‚Ø§Ù„Ø¨ Ø´Ù…Ø§Ø±Ù‡ Û³: Ø®Ù„Ø§Ù‚Ø§Ù†Ù‡ (Ù…ÛŒÙ†ÛŒÙ…Ø§Ù„) --- */
    .theme-creative { border-top: 10px solid #f43f5e; }
    .theme-creative .r-header { padding: 30px 30px 10px 30px; display: flex; justify-content: space-between; align-items: flex-end; }
    .theme-creative .r-name-box h1 { font-family: 'BTitr', sans-serif; font-size: 30pt; color: #f43f5e; margin: 0; line-height: 1; }
    .theme-creative .r-body { padding: 30px; display: block; column-count: 2; column-gap: 40px; column-rule: 1px solid #ddd; }
    .theme-creative .r-photo { width: 80px; height: 80px; border-radius: 20px; object-fit: cover; }
    .theme-creative .r-section { break-inside: avoid; margin-bottom: 25px; }
    .theme-creative .r-title { background: #f43f5e; color: white; padding: 5px 10px; border-radius: 5px; display: inline-block; margin-bottom: 10px; font-size: 12px; }

    /* --- Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ù…Ø´ØªØ±Ú© --- */
    .r-item { margin-bottom: 12px; }
    .r-item-head { font-weight: bold; font-size: 14px; display: flex; justify-content: space-between; }
    .r-item-sub { font-size: 11px; margin-bottom: 3px; opacity: 0.8; }
    .r-item-desc { font-size: 12px; line-height: 1.6; text-align: justify; }
    .skill-row { display: flex; align-items: center; gap: 10px; margin-bottom: 5px; }
    .skill-bar-bg { flex: 1; height: 6px; background: rgba(0,0,0,0.1); border-radius: 3px; overflow: hidden; }
    .theme-modern .skill-bar-bg { background: rgba(255,255,255,0.2); }
    .skill-bar-fill { height: 100%; background: #333; }
    .theme-modern .skill-bar-fill { background: #00eaff; }
    .theme-creative .skill-bar-fill { background: #f43f5e; }
    
    /* Ù‡Ø´Ø¯Ø§Ø± ØµÙØ­Ù‡ */
    .page-warning {
        position: absolute; bottom: 10px; right: 10px; background: rgba(255,0,0,0.1); color: red;
        font-size: 10px; padding: 5px; border: 1px solid red; border-radius: 5px; display: none;
    }
</style>

<div class="toolbar no-print" style="justify-content: space-between;">
    <div style="display:flex; gap:10px">
        <button class="btn btn-danger" onclick="closeZone()">Ø¨Ø§Ø²Ú¯Ø´Øª</button>
        <button class="btn btn-primary" onclick="document.getElementById('projectLoadInput').click()"><i class="fas fa-folder-open"></i> Ø¨Ø§Ø²Ú©Ø±Ø¯Ù† Ù¾Ø±ÙˆÚ˜Ù‡ (.sedat)</button>
        <input type="file" id="projectLoadInput" accept=".sedat" style="display:none" onchange="loadProject(this)">
    </div>
    <div style="display:flex; gap:10px; align-items:center">
        <span style="color:white; font-size:12px">Ù‚Ø§Ù„Ø¨ Ø±Ø²ÙˆÙ…Ù‡:</span>
        <select id="themeSelector" class="btn" style="padding: 5px 10px;" onchange="changeTheme(this.value)">
            <option value="classic">Ú©Ù„Ø§Ø³ÛŒÚ© (Ø±Ø³Ù…ÛŒ)</option>
            <option value="modern">Ù…Ø¯Ø±Ù† (Ø´ÛŒÚ©)</option>
            <option value="creative">Ø®Ù„Ø§Ù‚Ø§Ù†Ù‡ (Ø¯Ùˆ Ø³ØªÙˆÙ†Ù‡)</option>
        </select>
        <button class="btn btn-save" onclick="saveProject()"><i class="fas fa-save"></i> Ø°Ø®ÛŒØ±Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡</button>
        <button class="btn btn-primary" onclick="exportResumePDF()"><i class="fas fa-file-pdf"></i> Ø®Ø±ÙˆØ¬ÛŒ PDF</button>
    </div>
</div>

<div class="resume-split">
    <div class="resume-editor scroll-wrapper">
        <div class="res-group">
            <h4>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ø®ØµÛŒ</h4>
            <input class="res-input" placeholder="Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ" id="in_name" oninput="updateData('personal', 'name', this.value)">
            <input class="res-input" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø´ØºÙ„ÛŒ (Ù…Ø«Ù„Ø§Ù‹: Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù†ÙˆÛŒØ³)" id="in_job" oninput="updateData('personal', 'job', this.value)">
            <div style="display:flex; gap:5px">
                <input class="res-input" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³" id="in_phone" oninput="updateData('personal', 'phone', this.value)">
                <input class="res-input" placeholder="Ø§ÛŒÙ…ÛŒÙ„" id="in_email" oninput="updateData('personal', 'email', this.value)">
            </div>
            <input class="res-input" placeholder="Ø¢Ø¯Ø±Ø³ / ÙˆØ¨â€ŒØ³Ø§ÛŒØª" id="in_addr" oninput="updateData('personal', 'addr', this.value)">
            <button class="btn btn-primary" style="width:100%; font-size:12px; margin-top:5px" onclick="document.getElementById('resPhotoIn').click()">Ø§Ù†ØªØ®Ø§Ø¨ Ø¹Ú©Ø³ Ù¾Ø±Ø³Ù†Ù„ÛŒ</button>
            <input type="file" id="resPhotoIn" style="display:none" accept="image/*" onchange="updatePhoto(this)">
        </div>

        <div class="res-group">
            <h4>Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ù†</h4>
            <textarea class="res-input" rows="4" id="in_about" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©ÙˆØªØ§Ù‡..." oninput="updateData('personal', 'about', this.value)"></textarea>
        </div>

        <div class="res-group">
            <h4>Ø³ÙˆØ§Ø¨Ù‚ ØªØ­ØµÛŒÙ„ÛŒ <button class="res-btn-add" onclick="addItem('edu')">+</button></h4>
            <div id="editor_edu_list"></div>
        </div>

        <div class="res-group">
            <h4>Ø³ÙˆØ§Ø¨Ù‚ Ø´ØºÙ„ÛŒ <button class="res-btn-add" onclick="addItem('work')">+</button></h4>
            <div id="editor_work_list"></div>
        </div>

        <div class="res-group">
            <h4>Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§ <button class="res-btn-add" onclick="addItem('skill')">+</button></h4>
            <div id="editor_skill_list"></div>
        </div>
    </div>

    <div class="resume-preview-area" id="previewArea">
        <div id="resumePage1" class="resume-page theme-classic">
            </div>
    </div>
</div>

<script>
    // --- Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ (State Management) ---
    // Ø§ÛŒÙ† Ø¢Ø¨Ø¬Ú©Øª ØªÙ…Ø§Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø±Ø²ÙˆÙ…Ù‡ Ø±Ø§ Ù†Ú¯Ù‡ Ù…ÛŒâ€ŒØ¯Ø§Ø±Ø¯
    let resumeData = {
        theme: 'classic',
        personal: { name: 'Ù†Ø§Ù… Ø´Ù…Ø§', job: 'Ø¹Ù†ÙˆØ§Ù† Ø´ØºÙ„ÛŒ', phone: '', email: '', addr: '', about: '', photo: '' },
        edu: [],
        work: [],
        skill: []
    };

    // 1. ØªØ§Ø¨Ø¹ Ø±Ù†Ø¯Ø± Ú©Ø±Ø¯Ù† (Ù‚Ù„Ø¨ ØªÙ¾Ù†Ø¯Ù‡ Ø³ÛŒØ³ØªÙ…)
    // Ù‡Ø± ØªØºÛŒÛŒØ±ÛŒ Ú©Ù‡ Ø§ÛŒØ¬Ø§Ø¯ Ø´ÙˆØ¯ØŒ Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ú©Ù„ Ø±Ø²ÙˆÙ…Ù‡ Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù…ÛŒâ€ŒØ³Ø§Ø²Ø¯
    function renderResume() {
        const d = resumeData;
        const p = d.personal;
        
        // Ø³Ø§Ø®ØªØ§Ø± HTML Ø¨Ø± Ø§Ø³Ø§Ø³ Ù‚Ø§Ù„Ø¨ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
        let html = '';
        
        // --- Ú†ÛŒØ¯Ù…Ø§Ù† Ù…Ø­ØªÙˆØ§ Ø¨Ø± Ø§Ø³Ø§Ø³ ØªÙ… ---
        if (d.theme === 'classic') {
            html = `
                <div class="r-header">
                    ${p.photo ? `<img src="${p.photo}" class="r-photo">` : ''}
                    <div>
                        <h1 style="margin:0; font-size:24px">${p.name}</h1>
                        <p style="margin:5px 0; color:#666">${p.job}</p>
                        <div style="font-size:12px; margin-top:5px">
                            ${p.phone ? `<span>ğŸ“ ${p.phone}</span>` : ''} 
                            ${p.email ? `<span style="margin-right:10px">âœ‰ï¸ ${p.email}</span>` : ''}
                            ${p.addr ? `<span style="margin-right:10px">ğŸ“ ${p.addr}</span>` : ''}
                        </div>
                    </div>
                </div>
                <div class="r-body">
                    <div class="r-right">
                        ${renderSection('Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ù†', p.about ? `<p style="font-size:12px; text-align:justify">${p.about}</p>` : '')}
                        ${renderListSection('Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§', d.skill, 'skill')}
                        ${renderListSection('ØªØ­ØµÛŒÙ„Ø§Øª', d.edu, 'edu_simple')}
                    </div>
                    <div class="r-left">
                        ${renderListSection('Ø³ÙˆØ§Ø¨Ù‚ Ø´ØºÙ„ÛŒ', d.work, 'work')}
                    </div>
                </div>
            `;
        } 
        else if (d.theme === 'modern') {
            html = `
                <div class="r-header">
                    ${p.photo ? `<img src="${p.photo}" class="r-photo">` : ''}
                    <h1 style="margin:0; font-size:28px">${p.name}</h1>
                    <p style="margin:5px 0; opacity:0.8">${p.job}</p>
                </div>
                <div class="r-body">
                    <div class="r-left">
                        ${renderSection('Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ù†', `<p style="font-size:13px; text-align:justify; line-height:1.8">${p.about}</p>`)}
                        ${renderListSection('Ø³ÙˆØ§Ø¨Ù‚ Ø´ØºÙ„ÛŒ', d.work, 'work')}
                        ${renderListSection('Ø³ÙˆØ§Ø¨Ù‚ ØªØ­ØµÛŒÙ„ÛŒ', d.edu, 'work')} 
                    </div>
                    <div class="r-right">
                        <div class="r-title">Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÙ…Ø§Ø³</div>
                        <div style="font-size:12px; line-height:2">
                            ${p.phone} <br> ${p.email} <br> ${p.addr}
                        </div>
                        <br>
                        ${renderListSection('Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§', d.skill, 'skill')}
                    </div>
                </div>
            `;
        }
        else if (d.theme === 'creative') {
             html = `
                <div class="r-header">
                    <div class="r-name-box">
                        <h1>${p.name}</h1>
                        <p style="color:#666; font-size:14px">${p.job}</p>
                        <div style="font-size:11px; color:#888; margin-top:5px">
                            ${p.phone} | ${p.email} | ${p.addr}
                        </div>
                    </div>
                    ${p.photo ? `<img src="${p.photo}" class="r-photo">` : ''}
                </div>
                <div class="r-body">
                    ${p.about ? `<div class="r-section"><div class="r-title">Ù¾Ø±ÙˆÙØ§ÛŒÙ„</div><p style="font-size:12px">${p.about}</p></div>` : ''}
                    ${renderListSection('ØªØ¬Ø±Ø¨ÛŒØ§Øª Ú©Ø§Ø±ÛŒ', d.work, 'work')}
                    ${renderListSection('ØªØ­ØµÛŒÙ„Ø§Øª', d.edu, 'work')}
                    ${renderListSection('ØªØ®ØµØµâ€ŒÙ‡Ø§', d.skill, 'skill')}
                </div>
            `;
        }

        const page = document.getElementById('resumePage1');
        page.className = `resume-page theme-${d.theme}`; // Ø§Ø¹Ù…Ø§Ù„ Ú©Ù„Ø§Ø³ ØªÙ…
        page.innerHTML = html + '<div class="page-warning">Ù…ØªÙ† Ø§Ø² ØµÙØ­Ù‡ Ø®Ø§Ø±Ø¬ Ø´Ø¯!</div>';
        
        checkOverflow();
    }

    // ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø±Ù†Ø¯Ø±
    function renderSection(title, content) {
        if (!content) return '';
        return `<div class="r-section"><div class="r-title">${title}</div>${content}</div>`;
    }

    function renderListSection(title, items, type) {
        if (!items || items.length === 0) return '';
        let html = `<div class="r-section"><div class="r-title">${title}</div>`;
        
        items.forEach(item => {
            if (type === 'work' || type === 'edu_simple') {
                html += `
                    <div class="r-item">
                        <div class="r-item-head">
                            <span>${item.title}</span>
                            <span style="font-size:11px; color:#666">${item.date || ''}</span>
                        </div>
                        <div class="r-item-sub">${item.sub || ''}</div>
                        ${item.desc ? `<div class="r-item-desc">${item.desc}</div>` : ''}
                    </div>`;
            } else if (type === 'skill') {
                html += `
                    <div class="skill-row">
                        <span style="font-size:12px; width:40%">${item.title}</span>
                        <div class="skill-bar-bg"><div class="skill-bar-fill" style="width:${item.val}%"></div></div>
                    </div>`;
            }
        });
        return html + '</div>';
    }

    // 2. ØªÙˆØ§Ø¨Ø¹ Ø¢Ù¾Ø¯ÛŒØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø² Ø·Ø±ÛŒÙ‚ ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§
    function updateData(section, key, val) {
        if (section === 'personal') {
            resumeData.personal[key] = val;
        }
        renderResume();
    }

    function updatePhoto(input) {
        if (input.files && input.files[0]) {
            const r = new FileReader();
            r.onload = e => {
                resumeData.personal.photo = e.target.result;
                renderResume();
            };
            r.readAsDataURL(input.files[0]);
        }
    }

    // Ù…Ø¯ÛŒØ±ÛŒØª Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§ (Ø´ØºÙ„ØŒ ØªØ­ØµÛŒÙ„ØŒ Ù…Ù‡Ø§Ø±Øª)
    function addItem(type) {
        const id = Date.now();
        const newItem = { id: id, title: '', sub: '', date: '', desc: '', val: 50 };
        resumeData[type].push(newItem);
        renderEditorList(type); // Ø¨Ø§Ø²Ø³Ø§Ø²ÛŒ Ù„ÛŒØ³Øª Ø§ÛŒÙ†Ù¾ÙˆØªâ€ŒÙ‡Ø§
        renderResume();
    }

    function updateItem(type, id, key, val) {
        const item = resumeData[type].find(i => i.id === id);
        if(item) {
            item[key] = val;
            renderResume();
        }
    }

    function deleteItem(type, id) {
        resumeData[type] = resumeData[type].filter(i => i.id !== id);
        renderEditorList(type);
        renderResume();
    }

    // Ø³Ø§Ø®Øª Ø§ÛŒÙ†Ù¾ÙˆØªâ€ŒÙ‡Ø§ Ø¯Ø± Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø§Ø¯ÛŒØªÙˆØ±
    function renderEditorList(type) {
        const container = document.getElementById(`editor_${type}_list`);
        container.innerHTML = '';
        resumeData[type].forEach(item => {
            let inputs = '';
            if (type === 'skill') {
                inputs = `
                    <input class="res-input" style="width:60%" placeholder="Ù†Ø§Ù… Ù…Ù‡Ø§Ø±Øª" value="${item.title}" oninput="updateItem('${type}', ${item.id}, 'title', this.value)">
                    <input type="range" style="width:30%" min="0" max="100" value="${item.val}" oninput="updateItem('${type}', ${item.id}, 'val', this.value)">
                `;
            } else {
                inputs = `
                    <input class="res-input" placeholder="Ø¹Ù†ÙˆØ§Ù† (Ù…Ø«Ù„Ø§ Ù†Ø§Ù… Ø´Ø±Ú©Øª)" value="${item.title}" oninput="updateItem('${type}', ${item.id}, 'title', this.value)">
                    <div style="display:flex; gap:5px">
                        <input class="res-input" placeholder="Ø²ÛŒØ±Ø¹Ù†ÙˆØ§Ù† (Ø³Ù…Øª)" value="${item.sub}" oninput="updateItem('${type}', ${item.id}, 'sub', this.value)">
                        <input class="res-input" placeholder="ØªØ§Ø±ÛŒØ®" value="${item.date}" oninput="updateItem('${type}', ${item.id}, 'date', this.value)">
                    </div>
                    <textarea class="res-input" rows="2" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª" oninput="updateItem('${type}', ${item.id}, 'desc', this.value)">${item.desc}</textarea>
                `;
            }
            
            const div = document.createElement('div');
            div.style.cssText = 'border-bottom:1px solid #444; margin-bottom:10px; padding-bottom:5px;';
            div.innerHTML = `<i class="fas fa-trash del-btn" onclick="deleteItem('${type}', ${item.id})"></i>` + inputs;
            container.appendChild(div);
        });
    }

    // 3. ØªØºÛŒÛŒØ± ØªÙ…
    function changeTheme(themeName) {
        resumeData.theme = themeName;
        renderResume();
    }

    // 4. Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø±ØªÙØ§Ø¹ Ù…Ø­ØªÙˆØ§ (ØªØ´Ø®ÛŒØµ ØµÙØ­Ù‡ Ø¯ÙˆÙ…)
    function checkOverflow() {
        const page = document.getElementById('resumePage1');
        const warning = page.querySelector('.page-warning');
        
        // Ø§Ø±ØªÙØ§Ø¹ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ A4 Ø­Ø¯ÙˆØ¯ 1122 Ù¾ÛŒÚ©Ø³Ù„ Ø§Ø³Øª
        if (page.scrollHeight > 1130) {
            warning.style.display = 'block';
            warning.innerText = `âš ï¸ Ù…Ø­ØªÙˆØ§ Ø¨ÛŒØ´ØªØ± Ø§Ø² ÛŒÚ© ØµÙØ­Ù‡ A4 Ø´Ø¯! Ø¯Ø± Ø®Ø±ÙˆØ¬ÛŒ PDF Ø¨Ù‡ ØµÙØ­Ù‡ Ø¨Ø¹Ø¯ Ù…ÛŒâ€ŒØ±ÙˆØ¯.`;
        } else {
            warning.style.display = 'none';
        }
    }

    // 5. Ø°Ø®ÛŒØ±Ù‡ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ (.sedat)
    function saveProject() {
        const dataStr = JSON.stringify(resumeData);
        const blob = new Blob([dataStr], {type: "application/json"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `Resume_Project_${Date.now()}.sedat`;
        a.click();
    }

    function loadProject(input) {
        if (!input.files[0]) return;
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const loadedData = JSON.parse(e.target.result);
                // Ø§Ø¯ØºØ§Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª (Ø§Ú¯Ø± ÙÛŒÙ„Ø¯ÛŒ Ø¯Ø± ÙØ§ÛŒÙ„ Ù†Ø¨ÙˆØ¯ØŒ Ù…Ù‚Ø¯Ø§Ø± Ù¾ÛŒØ´ÙØ±Ø¶ Ø¨Ù…Ø§Ù†Ø¯)
                resumeData = { ...resumeData, ...loadedData };
                
                // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªÙ…Ø§Ù… Ø§ÛŒÙ†Ù¾ÙˆØªâ€ŒÙ‡Ø§ÛŒ Ø§Ø¯ÛŒØªÙˆØ± Ø¨Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
                document.getElementById('in_name').value = resumeData.personal.name || '';
                document.getElementById('in_job').value = resumeData.personal.job || '';
                document.getElementById('in_phone').value = resumeData.personal.phone || '';
                document.getElementById('in_email').value = resumeData.personal.email || '';
                document.getElementById('in_addr').value = resumeData.personal.addr || '';
                document.getElementById('in_about').value = resumeData.personal.about || '';
                document.getElementById('themeSelector').value = resumeData.theme;

                renderEditorList('edu');
                renderEditorList('work');
                renderEditorList('skill');
                
                renderResume();
                alert('Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯ Ùˆ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ù‡ÛŒØ¯!');
            } catch (err) {
                alert('ÙØ§ÛŒÙ„ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª.');
                console.error(err);
            }
        };
        reader.readAsText(input.files[0]);
        input.value = ''; // Ø±ÛŒØ³Øª Ú©Ø±Ø¯Ù† Ø§ÛŒÙ†Ù¾ÙˆØª ÙØ§ÛŒÙ„
    }

    // 6. Ø®Ø±ÙˆØ¬ÛŒ PDF (Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª Ú†Ù†Ø¯ ØµÙØ­Ù‡â€ŒØ§ÛŒ)
    function exportResumePDF() {
        const element = document.getElementById('resumePage1');
        const warning = element.querySelector('.page-warning');
        if(warning) warning.style.display = 'none'; // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù‡Ø´Ø¯Ø§Ø± Ù‚Ø¨Ù„ Ø§Ø² Ù¾Ø±ÛŒÙ†Øª

        // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² html2canvas Ø¨Ø±Ø§ÛŒ Ø¹Ú©Ø³ Ú¯Ø±ÙØªÙ† Ø§Ø² Ú©Ù„ Ø±Ø²ÙˆÙ…Ù‡
        html2canvas(element, { scale: 2, useCORS: true }).then(canvas => {
            const imgData = canvas.toDataURL('image/jpeg', 0.95);
            const { jsPDF } = window.jspdf;
            
            // Ø§Ø¨Ø¹Ø§Ø¯ A4 Ø¨Ù‡ Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ±
            const pdfWidth = 210;
            const pdfHeight = 297;
            
            const pdf = new jsPDF('p', 'mm', 'a4');
            const imgProps = pdf.getImageProperties(imgData);
            const imgHeight = (imgProps.height * pdfWidth) / imgProps.width;
            
            let heightLeft = imgHeight;
            let position = 0;

            // ØµÙØ­Ù‡ Ø§ÙˆÙ„
            pdf.addImage(imgData, 'JPEG', 0, position, pdfWidth, imgHeight);
            heightLeft -= pdfHeight;

            // Ø§Ú¯Ø± Ø§Ø±ØªÙØ§Ø¹ Ø¹Ú©Ø³ Ø¨ÛŒØ´ØªØ± Ø§Ø² ÛŒÚ© ØµÙØ­Ù‡ Ø¨ÙˆØ¯ØŒ ØµÙØ­Ø§Øª Ø¨Ø¹Ø¯ÛŒ Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
            while (heightLeft > 0) {
                position = heightLeft - imgHeight; // Ù…ÙˆÙ‚Ø¹ÛŒØª ØµÙØ­Ù‡ Ø¨Ø¹Ø¯ÛŒ
                pdf.addPage();
                pdf.addImage(imgData, 'JPEG', 0, position, pdfWidth, imgHeight);
                heightLeft -= pdfHeight;
            }

            pdf.save('My_Resume.pdf');
            if(warning) warning.style.display = 'block'; // Ù†Ù…Ø§ÛŒØ´ Ù…Ø¬Ø¯Ø¯ Ù‡Ø´Ø¯Ø§Ø±
        });
    }

    // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
    renderResume();
</script>
